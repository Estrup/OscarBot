kind: pipeline
name: default
type: docker

steps:  
- name: build
  image: docker:dind
  volumes:
  - name: dockersock
    path: /var/run/docker.sock
  commands:
  - docker build --no-cache -t oscarbot -f OscarBot/Dockerfile ./OscarBot

- name: clone
  image: alpine/git
  environment:
    GITAUTH:
      from_secret: gitauth
  commands:
  - git clone https://$GITAUTH@github.com/Estrup/SwarmVault.git

volumes:
- name: dockersock
  host:
    path: /var/run/docker.sock
